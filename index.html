<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ÂÜÜ„Éì„É´ „Éï„É≠„Ç¢„Ç¨„Ç§„Éâ</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;700&family=Space+Mono:wght@400;700&display=swap');

  :root {
    --bg: #f5f2ee;
    --panel: #ede9e3;
    --border: #a89880;
    --accent: #0d2444;
    --accent2: #8b1a10;
    --text: #0d0d0d;
    --muted: #3a3028;
    --wire: #0d2444;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Noto Sans JP', sans-serif;
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  header {
    padding: 12px 24px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 16px;
    background: rgba(245,242,238,0.97);
    backdrop-filter: blur(10px);
    z-index: 10;
  }

  .logo {
    font-family: 'Space Mono', monospace;
    font-size: 18px;
    color: var(--accent);
    letter-spacing: 2px;
  }

  .subtitle {
    font-size: 11px;
    color: var(--muted);
    letter-spacing: 1px;
  }

  .main {
    display: flex;
    flex: 1;
    overflow: hidden;
  }

  #canvas-container {
    flex: 1;
    position: relative;
    cursor: grab;
  }

  #canvas-container:active { cursor: grabbing; }

  canvas { display: block; }

  .hint {
    position: absolute;
    bottom: 16px;
    left: 50%;
    transform: translateX(-50%);
    font-family: 'Space Mono', monospace;
    font-size: 10px;
    color: var(--muted);
    background: rgba(245,242,238,0.9);
    padding: 6px 14px;
    border: 1px solid var(--border);
    border-radius: 20px;
    letter-spacing: 1px;
    pointer-events: none;
  }

  .sidebar {
    width: 300px;
    border-left: 1px solid var(--border);
    overflow-y: auto;
    background: var(--panel);
    display: flex;
    flex-direction: column;
  }

  .sidebar-header {
    padding: 16px;
    border-bottom: 1px solid var(--border);
    font-family: 'Space Mono', monospace;
    font-size: 11px;
    color: var(--accent);
    letter-spacing: 2px;
  }

  .floor-card {
    border-bottom: 1px solid var(--border);
    cursor: pointer;
    transition: background 0.2s;
    padding: 14px 16px;
    position: relative;
  }

  .floor-card:hover { background: rgba(26,58,107,0.05); }
  .floor-card.active { background: rgba(26,58,107,0.08); border-left: 3px solid var(--accent); }

  .floor-num {
    font-family: 'Space Mono', monospace;
    font-size: 22px;
    font-weight: 700;
    line-height: 1;
    margin-bottom: 4px;
  }

  .floor-name {
    font-size: 13px;
    font-weight: 700;
    margin-bottom: 6px;
    color: var(--text);
  }

  .floor-items {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin-top: 6px;
  }

  .tag {
    font-size: 10px;
    padding: 2px 8px;
    border-radius: 10px;
    background: rgba(0,0,0,0.05);
    color: var(--muted);
    border: 1px solid var(--border);
  }

  .floor-area {
    font-family: 'Space Mono', monospace;
    font-size: 10px;
    color: var(--muted);
    margin-top: 6px;
  }

  .color-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    display: inline-block;
    margin-right: 6px;
    vertical-align: middle;
  }

  /* scrollbar */
  .sidebar::-webkit-scrollbar { width: 4px; }
  .sidebar::-webkit-scrollbar-track { background: var(--panel); }
  .sidebar::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }
</style>
</head>
<body>

<header>
  <div>
    <div class="logo">LANTANA BLD.</div>
    <div class="subtitle">LANTANA BLD. ‚Äî „Éï„É≠„Ç¢„Ç¨„Ç§„Éâ 3D VIEW</div>
  </div>
</header>

<div class="main">
  <div id="canvas-container">
    <canvas id="c"></canvas>
    <div class="hint">üñ± „Éâ„É©„ÉÉ„Ç∞„ÅßÂõûËª¢ Ôºè „Çπ„ÇØ„É≠„Éº„É´„Åß„Ç∫„Éº„É†</div>
  </div>

  <div class="sidebar">
    <div class="sidebar-header">FLOOR INFORMATION</div>

    <div class="floor-card active" data-floor="1" onclick="selectFloor(1)">
      <div class="floor-num"><span class="color-dot" style="background:#8b1a10"></span>1F</div>
      <div class="floor-name">LANTANA È£üÂ†Ç</div>
      <div class="floor-items">
        <span class="tag">È£≤È£üÂ∫ó</span>
        <span class="tag">„ÉÜ„Ç§„ÇØ„Ç¢„Ç¶„Éà</span>
        <span class="tag">Âé®Êàø</span>
        <span class="tag">ÂÄâÂ∫´</span>
        <span class="tag">WC</span>
      </div>
      <div class="floor-area">Âª∂Â∫äÈù¢Á©ç Á¥Ñ 99m¬≤</div>
    </div>

    <div class="floor-card" data-floor="2" onclick="selectFloor(2)">
      <div class="floor-num"><span class="color-dot" style="background:#7a3c00"></span>2F</div>
      <div class="floor-name">LANTANA CAPSULE HOTEL</div>
      <div class="floor-items">
        <span class="tag">ÂÆ¢ÂÆ§ 1„Äú6Âè∑ÂÆ§</span>
        <span class="tag">Âèó‰ªò</span>
        <span class="tag">„Çπ„Çø„ÉÉ„Éï„É´„Éº„É†</span>
        <span class="tag">„Ç∑„É£„ÉØ„ÉºÂÆ§</span>
        <span class="tag">WC</span>
      </div>
      <div class="floor-area">33.98„é°ÔºàÂÆøÊ≥ä„Ç®„É™„Ç¢ÔºâÔºè 12Âêç</div>
    </div>

    <div class="floor-card" data-floor="3" onclick="selectFloor(3)">
      <div class="floor-num"><span class="color-dot" style="background:#145a32"></span>3F</div>
      <div class="floor-name">LANTANA CAPSULE HOTEL</div>
      <div class="floor-items">
        <span class="tag">ÂÆ¢ÂÆ§ 1„Äú14Âè∑ÂÆ§</span>
        <span class="tag">„É©„É≥„Éâ„É™„Éº</span>
        <span class="tag">ÂÄâÂ∫´</span>
        <span class="tag">MWC</span>
      </div>
      <div class="floor-area">57.35„é°ÔºàÂÆøÊ≥ä„Ç®„É™„Ç¢ÔºâÔºè 28Âêç</div>
    </div>

    <div class="floor-card" data-floor="4" onclick="selectFloor(4)">
      <div class="floor-num"><span class="color-dot" style="background:#0d2e5a"></span>4F</div>
      <div class="floor-name">LANTANA STUDY ROOM</div>
      <div class="floor-items">
        <span class="tag">Ëá™ÁøíÂÆ§ 18Âêç</span>
        <span class="tag">‰ºëÊÜ©ÂÆ§</span>
        <span class="tag">MWC</span>
      </div>
      <div class="floor-area">Ëá™ÁøíÂÆ§ 39.49„é° Ôºè ‰ºëÊÜ©ÂÆ§ 30.93„é°</div>
    </div>

    <div class="floor-card" data-floor="5" onclick="selectFloor(5)">
      <div class="floor-num"><span class="color-dot" style="background:#4a1060"></span>5F</div>
      <div class="floor-name">LANTANA RESIDENCE</div>
      <div class="floor-items">
        <span class="tag">„É¨„É≥„Çø„É´„É´„Éº„É† 1</span>
        <span class="tag">„É¨„É≥„Çø„É´„É´„Éº„É† 2</span>
      </div>
      <div class="floor-area">„É´„Éº„É†1 20.61„é° Ôºè „É´„Éº„É†2 25.12„é°</div>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
// ===== Scene setup =====
const container = document.getElementById('canvas-container');
const canvas = document.getElementById('c');

const renderer = new THREE.WebGLRenderer({ canvas, antialias: true, alpha: true });
renderer.setPixelRatio(window.devicePixelRatio);

const scene = new THREE.Scene();
scene.background = new THREE.Color(0xf5f2ee);

const camera = new THREE.PerspectiveCamera(45, 1, 0.1, 1000);
camera.position.set(30, 35, 45);
camera.lookAt(0, 10, 0);

// ===== Floor colors =====
const floorColors = {
  1: 0x8b1a10,  // very dark red
  2: 0x7a3c00,  // very dark orange/brown
  3: 0x145a32,  // very dark green
  4: 0x0d2e5a,  // very dark blue
  5: 0x4a1060   // very dark purple
};

// ===== Building geometry from drawings =====
// Main body: 14.1m wide x 6.65m deep x 5 floors (each ~3.5m)
// Annex (right side): extends from main body

const SCALE = 0.5; // 1 unit = 2m
const W = 14.1 * SCALE;   // main width
const D = 6.65 * SCALE;   // main depth
const FH = 3.5 * SCALE;   // floor height
const AW = 7.5 * SCALE;   // annex width
const AD = 2.2 * SCALE;   // annex depth

let selectedFloor = 1;
const floorGroups = {};

// Helper: create wireframe box at position
function makeWireBox(w, h, d, x, y, z, color, opacity = 1) {
  const geo = new THREE.BoxGeometry(w, h, d);
  const mat = new THREE.MeshBasicMaterial({
    color,
    wireframe: true,
    transparent: true,
    opacity
  });
  const mesh = new THREE.Mesh(geo, mat);
  mesh.position.set(x, y, z);
  return mesh;
}

// Helper: solid face for floor slabs
function makeFloorSlab(w, d, x, y, z, color) {
  const geo = new THREE.PlaneGeometry(w, d);
  const mat = new THREE.MeshBasicMaterial({
    color,
    transparent: true,
    opacity: 0.08,
    side: THREE.DoubleSide
  });
  const mesh = new THREE.Mesh(geo, mat);
  mesh.rotation.x = -Math.PI / 2;
  mesh.position.set(x, y, z);
  return mesh;
}

// Build each floor
for (let f = 1; f <= 5; f++) {
  const group = new THREE.Group();
  const y = (f - 1) * FH;
  const col = floorColors[f];
  const isActive = f === selectedFloor;

  // Main building volume
  const mainBox = makeWireBox(W, FH, D, 0, y + FH/2, 0, col, isActive ? 1 : 0.45);
  group.add(mainBox);

  // Floor 1-3: annex on right side
  if (f <= 3) {
    const annexX = W/2 + AW/2;
    const annexBox = makeWireBox(AW, FH, AD, annexX, y + FH/2, D/2 - AD/2, col, isActive ? 1 : 0.45);
    group.add(annexBox);
  }

  // Floor slab
  const slab = makeFloorSlab(W, D, 0, y, 0, col);
  group.add(slab);

  // Label (3D sprite via canvas texture)
  const labelCanvas = document.createElement('canvas');
  labelCanvas.width = 256; labelCanvas.height = 128;
  const ctx = labelCanvas.getContext('2d');
  ctx.clearRect(0,0,256,128);
  ctx.font = 'bold 48px monospace';
  ctx.fillStyle = '#4a1060' === '#' + col.toString(16).padStart(6,'0') ? '#4a1060' : '#' + col.toString(16).padStart(6,'0');
  ctx.fillText(f + 'F', 10, 56);
  const names = ['LANTANA È£üÂ†Ç','CAPSULE HOTEL','CAPSULE HOTEL','STUDY ROOM','RESIDENCE'];
  ctx.font = '22px sans-serif';
  ctx.fillStyle = '#1a0f08';
  ctx.fillText(names[f-1], 10, 90);

  const tex = new THREE.CanvasTexture(labelCanvas);
  const spriteMat = new THREE.SpriteMaterial({ map: tex, transparent: true });
  const sprite = new THREE.Sprite(spriteMat);
  sprite.scale.set(8, 4, 1);
  sprite.position.set(-W/2 - 4.5, y + FH/2, 0);
  group.add(sprite);

  floorGroups[f] = group;
  scene.add(group);
}

// Grid
const gridHelper = new THREE.GridHelper(60, 30, 0xa89880, 0xc8bfb0);
scene.add(gridHelper);

// Axis lines (ground outline)
const groundGeo = new THREE.EdgesGeometry(new THREE.BoxGeometry(W, 0.02, D));
const groundMat = new THREE.LineBasicMaterial({ color: 0xc8bfb0 });
const ground = new THREE.LineSegments(groundGeo, groundMat);
ground.position.y = 0;
scene.add(ground);

// ===== Resize =====
function resize() {
  const w = container.clientWidth;
  const h = container.clientHeight;
  renderer.setSize(w, h);
  camera.aspect = w / h;
  camera.updateProjectionMatrix();
}
resize();
window.addEventListener('resize', resize);

// ===== Orbit controls (manual) =====
let isDragging = false;
let prevX = 0, prevY = 0;
let rotX = 0.3, rotY = 0.5;
let zoom = 55;
const target = new THREE.Vector3(0, 4.375, 0);

canvas.addEventListener('mousedown', e => { isDragging = true; prevX = e.clientX; prevY = e.clientY; });
window.addEventListener('mouseup', () => { isDragging = false; });
window.addEventListener('mousemove', e => {
  if (!isDragging) return;
  rotY += (e.clientX - prevX) * 0.01;
  rotX += (e.clientY - prevY) * 0.01;
  rotX = Math.max(-1.2, Math.min(1.2, rotX));
  prevX = e.clientX; prevY = e.clientY;
});
canvas.addEventListener('wheel', e => {
  zoom = Math.max(10, Math.min(120, zoom + e.deltaY * 0.05));
});

// Touch
canvas.addEventListener('touchstart', e => {
  isDragging = true;
  prevX = e.touches[0].clientX; prevY = e.touches[0].clientY;
});
canvas.addEventListener('touchend', () => { isDragging = false; });
canvas.addEventListener('touchmove', e => {
  if (!isDragging) return;
  rotY += (e.touches[0].clientX - prevX) * 0.01;
  rotX += (e.touches[0].clientY - prevY) * 0.01;
  prevX = e.touches[0].clientX; prevY = e.touches[0].clientY;
});

// ===== Select floor =====
window.selectFloor = function(f) {
  selectedFloor = f;
  document.querySelectorAll('.floor-card').forEach(el => el.classList.remove('active'));
  document.querySelector(`[data-floor="${f}"]`).classList.add('active');
  updateFloorVisibility();
};

function updateFloorVisibility() {
  for (let f = 1; f <= 5; f++) {
    const grp = floorGroups[f];
    const isActive = f === selectedFloor;
    grp.children.forEach(child => {
      if (child.material) {
        if (child.material.wireframe) {
          child.material.opacity = isActive ? 1 : 0.45;
        } else {
          child.material.opacity = isActive ? 0.15 : 0.06;
        }
      }
    });
    // Scale up active floor slightly
    grp.scale.setScalar(isActive ? 1.0 : 1.0);
  }
}

// ===== Animate =====
let time = 0;
function animate() {
  requestAnimationFrame(animate);
  time += 0.01;

  // Subtle auto-rotation when not dragging
  if (!isDragging) rotY += 0.003;

  // Camera orbit
  const r = zoom;
  camera.position.x = target.x + r * Math.sin(rotY) * Math.cos(rotX);
  camera.position.y = target.y + r * Math.sin(rotX);
  camera.position.z = target.z + r * Math.cos(rotY) * Math.cos(rotX);
  camera.lookAt(target);

  // Pulse active floor
  const activeGroup = floorGroups[selectedFloor];
  activeGroup.children.forEach(child => {
    if (child.material && child.material.wireframe) {
      child.material.opacity = 0.7 + 0.3 * Math.sin(time * 2);
    }
  });

  renderer.render(scene, camera);
}
animate();

updateFloorVisibility();
</script>
</body>
</html>
